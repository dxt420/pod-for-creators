<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Pod for Creators</title>
    <meta name="description" content="Responsive, Bootstrap, BS4">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><!-- style -->
    <link rel="stylesheet" href="/static/bl/assets/css/site.min.css">

    <link rel="stylesheet" href="/static/bl/assets/css/mycss.css">



    


</head>

<body class="layout-row">
    <!-- ############ Aside START-->
    <div id="aside" class="page-sidenav no-shrink bg-light nav-dropdown fade" aria-hidden="true">
        <div class="sidenav h-100 modal-dialog bg-light">
            <!-- sidenav top -->
            <div class="navbar">
                <!-- brand --> <a href="#" class="navbar-brand">
             
                    <img src="/static/bl/assets/img/logo-light.png" alt="..."> 
                   
            </div><!-- Flex nav content -->
            <div class="flex scrollable hover">
                <div class="nav-active-text-primary" data-nav>
                    <ul class="nav bg">
                
                        <li><a href={% url 'bl:dashboard' %}><span class="nav-icon text-primary"><i
                                        data-feather="home"></i></span> <span class="nav-text">Overview</span></a></li>
                                        <li><a href={% url 'bl:mypod' %}><span class="nav-icon  text-info"><i
                                            data-feather="disc"></i></span> <span class="nav-text">My Pod</span></a></li>
                                            <li><a href="#"><span class="nav-icon  text-success"><i
                                                data-feather="pie-chart"></i></span> <span class="nav-text">Stats</span>
                                                <span class="nav-badge"><b class="badge-circle xs text-success"></b></span>
                                            </a></li>

                                            <li><a href="#"><span class="nav-icon  text-success"><i
                                                data-feather="pie-chart"></i></span> <span class="nav-text">My Profile</span>
                                                <span class="nav-badge"><b class="badge-circle xs text-success"></b></span>
                                            </a></li>

                                            <li><a href="#"><span class="nav-icon  text-success"><i
                                                data-feather="pie-chart"></i></span> <span class="nav-text">Team</span>
                                                <span class="nav-badge"><b class="badge-circle xs text-success"></b></span>
                                            </a></li>
                      
                        <li><a href="app.message.html"><span class="nav-icon text-warning"><i
                                        data-feather="message-circle"></i></span> <span class="nav-text">Preferences</span>
                               </a></li>
                      
                    </ul>
                 
                </div>
            </div><!-- sidenav bottom -->
            <div class="no-shrink">
                <div class="p-3 d-flex align-items-center">
                    <div class="text-sm hidden-folded text-muted">Quota: 2%</div>
                    <div class="progress mx-2 flex" style="height:4px">
                        <div class="progress-bar gd-success" style="width: 2%"></div>
                    </div>
                </div>
            </div>
        </div>
    </div><!-- ############ Aside END-->
    <div id="main" class="layout-column flex">
        <!-- ############ Header START-->
        <div id="header" class="page-header">
            <div class="navbar navbar-expand-lg">
                <!-- brand --> <a href="#" class="navbar-brand d-lg-none"><svg width="32" height="32"
                        viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" fill="currentColor">
                        <g class="loading-spin" style="transform-origin: 256px 256px">
                            <path
                                d="M200.043 106.067c-40.631 15.171-73.434 46.382-90.717 85.933H256l-55.957-85.933zM412.797 288A160.723 160.723 0 0 0 416 256c0-36.624-12.314-70.367-33.016-97.334L311 288h101.797zM359.973 134.395C332.007 110.461 295.694 96 256 96c-7.966 0-15.794.591-23.448 1.715L310.852 224l49.121-89.605zM99.204 224A160.65 160.65 0 0 0 96 256c0 36.639 12.324 70.394 33.041 97.366L201 224H99.204zM311.959 405.932c40.631-15.171 73.433-46.382 90.715-85.932H256l55.959 85.932zM152.046 377.621C180.009 401.545 216.314 416 256 416c7.969 0 15.799-.592 23.456-1.716L201.164 288l-49.118 89.621z">
                            </path>
                        </g>
                    </svg><!-- <img src="/static/bl/assets/img/logo.png" alt="..."> --> <span
                        class="hidden-folded d-inline l-s-n-1x d-lg-none">Pod for Creators</span> </a><!-- / brand -->
                <!-- Navbar collapse -->
              
                <ul class="nav navbar-menu order-1 order-lg-2">
                    <li class="nav-item d-none d-sm-block"><a class="nav-link px-2" data-toggle="fullscreen"
                            data-plugin="fullscreen"><i data-feather="maximize"></i></a></li>
                    <li class="nav-item dropdown"><a class="nav-link px-2" data-toggle="dropdown"><i
                                data-feather="settings"></i> </a><!-- ############ Setting START-->
                        <div class="dropdown-menu dropdown-menu-center mt-3 w-md animate fadeIn">
                            <div class="setting px-3">
                                <div class="mb-2 text-muted"><strong>Setting:</strong></div>
                               
                                <div class="mb-2 text-muted"><strong>Color Mode:</strong></div>
                                <div class="mb-2"><label class="radio radio-inline ui-check ui-check-md"><input
                                            type="radio" name="bg" value=""> <i></i></label><label
                                        class="radio radio-inline ui-check ui-check-color ui-check-md"><input
                                            type="radio" name="bg" value="bg-dark"> <i class="bg-dark"></i></label>
                                </div>
                             
                             
                            </div>
                        </div><!-- ############ Setting END-->
                    </li><!-- Notification -->
                    <li class="nav-item dropdown"><a class="nav-link px-2 mr-lg-2" data-toggle="dropdown"><i
                                data-feather="bell"></i> 
                                <!-- <span class="badge badge-pill badge-up bg-primary">4</span> -->
                        </a><!-- dropdown -->
                        <div class="dropdown-menu dropdown-menu-right mt-3 w-md animate fadeIn p-0">
                            <div class="scrollable hover" style="max-height: 250px">
                                <div class="list list-row">
                                        {% load notification_tags %}
                                        {% user_notifications for box %} 

                                </div>
                            </div>
                            <!-- <div class="d-flex px-3 py-2 b-t">
                                <div class="flex"><span>6 Notifications</span></div><a href="#">See all
                                    <i class="fa fa-angle-right text-muted"></i></a>
                            </div> -->
                        </div><!-- / dropdown -->
                    </li><!-- User dropdown menu -->
                    <li class="nav-item dropdown"><a href="#" data-toggle="dropdown"
                            class="nav-link d-flex align-items-center px-2 text-color"><span class="avatar w-24"
                                style="margin: -2px">
                                
                               
                            
                                {% for a in backends.associated %}
                             
                           
                                <img src="{{a.extra_data.picture}}" alt="...">

                          
                            {% endfor %}
                            
                            </span></a>
                        <div class="dropdown-menu dropdown-menu-right w mt-3 animate fadeIn">
                                <a class="dropdown-item"
                                href={% url 'logout' %} >Sign out</a>
                        </div>
                    </li><!-- Navarbar toggle btn -->
                    <li class="nav-item d-lg-none"><a href="#" class="nav-link px-2" data-toggle="collapse"
                            data-toggle-class data-target="#navbarToggler"><i data-feather="search"></i></a></li>
                    <li class="nav-item d-lg-none"><a class="nav-link px-1" data-toggle="modal" data-target="#aside"><i
                                data-feather="menu"></i></a></li>
                </ul>
            </div>
        </div><!-- ############ Footer END-->
      
  
<div id="content" class="flex">
    <!-- ############ Main START-->
    <div>
        <div class="page-hero page-container" id="page-hero">
            <div class="padding d-flex">
                <div class="col-sm-12">
                    <div class="card">
                        <div class="b-b">
                            <div class="nav-active-border b-success top">
                                <ul class="nav" id="myTab" role="tablist">
                                    <li class="nav-item"><a class="nav-link active" id="home-tab"
                                            data-toggle="tab" href="#home4" role="tab" aria-controls="home"
                                            aria-selected="true">Upload</a></li>
                                    <li class="nav-item"><a class="nav-link" id="profile-tab" data-toggle="tab"
                                            href="#profile4" role="tab" aria-controls="profile"
                                            aria-selected="false">Profile</a></li>
                                    <li class="nav-item"><a class="nav-link" id="contact-tab" data-toggle="tab"
                                            href="#contact4" role="tab" aria-controls="contact"
                                            aria-selected="false">Contact</a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="tab-content p-3">
                            <div class="tab-pane fade show active" id="home4" role="tabpanel"
                                aria-labelledby="home-tab">
                                <div class="padding">

                                    <form action="#" method="POST" id="my-awesome-dropzone"
                                        class="dropzone white b-a b-3x b-dashed b-primary p-a rounded p-5 text-center"
                                        data-plugin="dropzone" data-option="#">

                                        {% csrf_token %}
                                        <div class="dz-message">
                                            <h4 class="my-4">Drag and drop your tracks here</h4><span
                                                class="text-muted d-block mb-4">(Recommended files are
                                                <strong>.mp3, .m4a, .wav .flac, .alac or .aiff</strong> for best
                                                audio experiences uploaded.)</span>
                                        </div>
                                    </form>

                                </div>
                                <div id="former" class="scroll-y mx-3 mb-3 card">

                                </div>



                                <div class="tab-pane fade" id="profile4" role="tabpanel"
                                    aria-labelledby="profile-tab">
                                    <p>Rhoncus non diam cras rutrum pretium adipiscing sagittis, amet, facilisi
                                        porttitor ac odio sed id viverra malesuada ipsum vel metus</p>
                                </div>
                                <div class="tab-pane fade" id="contact4" role="tabpanel"
                                    aria-labelledby="contact-tab">
                                    <p>Duis id in nisl, euismod morbi rutrum varius tempus sollicitudin justo
                                        neque tortor, et diam placerat leo cras lacus sem</p>
                                </div>
                            </div>
                        </div>
                    </div>


                </div>
            </div>

        </div><!-- ############ Main END-->
    </div><!-- ############ Content END-->






        <!-- ############ Footer START-->
        <div id="footer" class="page-footer hide">
            <div class="d-flex p-3"><span class="text-sm text-muted flex">&copy; Copyright</span>
                <div class="text-sm text-muted">Version 0.0.1</div>
            </div>
        </div><!-- ############ Footer END-->
    </div>
    <script src="/static/bl/assets/js/site.min.js"></script>

    <script src="/static/bl/libs/dropzone/dist/min/dropzone.min.js"></script>
<script>
    // Dropzone.autoDiscover = false;

    Dropzone.options.myAwesomeDropzone = {
        acceptedFiles: ".mp3,.m4a,.wav,.flac,.alac,.aiff",
        maxFiles: 2,
        // addRemoveLinks: true,
        init:  function () {
            this.on("complete", function (file) {
                // this.removeFile(file); 
                //   alert("Complete."); 
                // console.log(file);
            });


            this.on("addedfile", function (file) {
              
                var formData = new FormData();
             
                formData.append('file', file);
              
                var frm = $('#my-awesome-dropzone');

                var urlx = "{% url 'bl:gettags' %}";
                var urly = urlx.replace('123', file.name);
                var kkk=this;
                $.ajax({
                    type: frm.attr('method'),
                    url: urlx,
                    data: formData,
                    async: true,
                    processData: false,
                    contentType: false,
                    success: function (data) {
                        
                        
                        // document.getElementById('cartCounter').setAttribute("data-badge", data.total_items);
                        console.log("pass");
                        console.log(data);


                        // var cover_art = data.image;
                        // var title = data.title;

                        // if (condition) {
                            
                        // }else{

                        // }
                       
                   

                        const toBase64 = file => new Promise((resolve, reject) => {
                            const reader = new FileReader();
                            reader.readAsDataURL(file);
                            reader.onload = () => resolve(reader.result);
                            reader.onerror = error => reject(error);
                        });

                        // var kkk=this;
                     
                            // console.log( toBase64(file));

                            // var songFile = toBase64(file)  + "";


                            toBase64(file).then(function(value) {
                                // console.log(value);
                                // expected output: "Success!"
                                var scratch = '<form id="songFormer" method="post" enctype="multipart/form-data">{% csrf_token %}  <div class="p-4 d-sm-flex no-shrink b-b"><div class="col-4 d-flex"><div class="avatar-upload"> <div class="avatar-edit"> <input name="imageUpload" id="fileHolder" type="text" ><input type="file"  id="imageUpload" accept=".png, .jpg, .jpeg"/> <label for="imageUpload"></label> </div><div class="avatar-preview"> <div id="imagePreview" style="background-image: url(' + data.image + ');"> </div></div></div></div><div class="col-8 px-sm-4 my-3 my-sm-0 flex"> <div class="form-group row"> <div class="col-sm-12"><label>Title</label><input type="text" name="title" class="form-control" value="'+ data.title +'" placeholder="Name" required> <input type="text" name="songFile" value="'+ value +'">  </div></div><div class="form-group"><label>Description (Optional)</label><textarea class="form-control" rows="6" placeholder="hmm.."></textarea></div><a  onclick="addSong()" class="btn btn-primary">Submit</a> </div><div><a href="#" class="btn btn-icon btn-rounded"><i data-feather="mail"></i> </a><a href="#" class="btn btn-icon btn-rounded"><i data-feather="more-vertical"></i></a></div></div></div></form>';
                       
                                document.getElementById("former").innerHTML += scratch;


                                kkk.removeFile(file); 
                                });

                          

                                // this.removeFile(file); 

                        //    console.log(file);
                        

                    },
                    error: function (data) {
                        // $("#MESSAGE-DIV").html("Something went wrong!");
                        console.log("fail");

                    }
                });
                
            });


            // this.on("removedfile", function (file) {
            //     alert("removedfile ");
            //     console.log(file);
            // });




        }
    };




    


    function addSong(){
        // var feat = document.getElementsByClassName('feat'+a);
        // for (var i = 0; i < feat.length; i++) { 
        //     if (feat[i].checked) {
        //         console.log(feat[i].value);
        //         document.getElementById('featured'+a).value = feat[i].value;
                
        //     }else{
        //     }
        //     // feat[i].disabled = false;
        // }
        // var feat = document.querySelector('input[name="rsvp"]:checked').value;
        
        var frm = $('#songFormer');
        var urlx = "{% url 'bl:addsong' %}";
        // var urly = urlx.replace('123',a);
        // frm.submit(function () {
            console.log(frm.serialize());
            $.ajax({
                type: frm.attr('method'),
                url: urlx,
                data: frm.serialize(),
                async:true,
                // processData: false,
                    // contentType: false,
                success: function (data) {
            
               // document.getElementById('cartCounter').setAttribute("data-badge", data.total_items);
               console.log("pass"); 
               frm.hide();
               
               console.log(data); 
                },
                error: function(data) {
                    // $("#MESSAGE-DIV").html("Something went wrong!");
                    console.log("fail"); 
                    console.log(data); 
                
                }
            });
            return false;
        // });
    }

</script>


<script>
    function getCookie(name) {
        var cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            var cookies = document.cookie.split(';');
            for (var i = 0; i < cookies.length; i++) {
                var cookie = jQuery.trim(cookies[i]);
                // Does this cookie string begin with the name we want?
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
    var csrftoken = getCookie('csrftoken');

    function csrfSafeMethod(method) {
        // these HTTP methods do not require CSRF protection
        return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
    }
    $.ajaxSetup({
        beforeSend: function (xhr, settings) {
            if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
                xhr.setRequestHeader("X-CSRFToken", csrftoken);
            }
        }
    });


    function readURL(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();
            var imageData;
          

            reader.onload = (e) => {
                $('#imagePreview').css('background-image', 'url(' + e.target.result + ')');
                $('#imagePreview').hide();
                $('#imagePreview').fadeIn(650);
                // $('#fileHolder').val(e.target.result+"");
                // console.log(e.target.result);
                
                imageData = e.target.result+"";
                $('#fileHolder').val(imageData);
            // console.log(imageData);
            }



            reader.readAsDataURL(input.files[0]);


            
            console.log(input.files[0]);
           
        }
    }
    // $("#imageUpload").change(function () {
    //     readURL(this);
    // });


    $(document).on('change', '#imageUpload', function(){
        readURL(this);
    });
</script>
</body>

</html>



